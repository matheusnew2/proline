import{c as r,o,b as s,r as _,d as B,F as p,e as g,f as u,g as $,h as m,t as a,n as b,u as y,i as N}from"./main-DKFl5z_J.js";import{h as v}from"./http-pf5UM4Pc.js";function w(j,c){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})])}const V={class:"w-3/4 m-auto flex flex-col gap-4"},L=["onClick"],q={class:"text-white text-xl font-bold flex justify-between"},E={class:"flex flex-col justify-between"},F={class:"bg-red-300 rounded p-4 flex flex-col m-2"},J={key:0,class:"flex justify-end"},R={class:"flex justify-between w-full"},Z={class:""},z={class:"text-xs"},A={class:"text-sm ml-5"},D={key:1,class:"flex flex-col gap-2 mt-5"},M={__name:"ListagemEnvios",setup(j){const c=_({batches:[]}),n=_({jobs:[]}),f=B("");x(),setInterval(async()=>{x()},3e3);function x(){v.get("/uploads").then(l=>{c.batches=l.data,f.value&&h(f.value)}).catch(l=>{c.batches=[]})}function h(l){f.value=l,v.get(`/uploads/${l}`).then(i=>{n.jobs=i.data}).catch(i=>{})}function k(l){v.post(`/uploads/${l}/reprocess`).then(i=>{}).catch(i=>{c.batches=[]})}function C(l){v.post(`/uploads/job/${l}/reprocess`).then(i=>{}).catch(i=>{c.batches=[]})}return(l,i)=>(o(),r("div",null,[s("div",V,[i[0]||(i[0]=s("label",{class:"text-white text-4xl"},"Lista de uploads",-1)),(o(!0),r(p,null,g(c.batches,e=>(o(),r("div",null,[s("div",{class:"bg-gray-500 p-4 rounded-lg",onClick:t=>h(e.id)},[s("div",q,[s("div",E,[s("label",null,[m("Upload NÂº "+a(e.name)+" ",1),s("button",{class:b(["rounded p-1 text-sm",{"bg-amber-300":e.status=="pending"||e.status=="processing","bg-red-500":e.status=="failed","bg-green-500":e.status=="success"}])},a(e.status),3),m(" "+a(e.progress)+"% ",1)])]),e.status=="failed"?(o(),$(y(w),{key:0,onClick:t=>k(e.id),class:"w-[30px] hover:text-gray-300 hover:cursor-pointer"},null,8,["onClick"])):u("",!0)]),n.jobs[e.id]?(o(),r(p,{key:0},[n.jobs[e.id].failed_jobs.length>0?(o(!0),r(p,{key:0},g(n.jobs[e.id].failed_jobs,t=>(o(),r("div",F,[t.retry?u("",!0):(o(),r("div",J,[N(y(w),{onClick:d=>C(t.id),class:"w-[15px] hover:text-gray-300 hover:cursor-pointer"},null,8,["onClick"])])),s("div",R,[s("label",Z,a(t.name)+" "+a(t.retry?"(Retry)":""),1),s("i",z,a(t.date),1)]),s("label",A,a(t.exception),1)]))),256)):u("",!0),n.jobs[e.id].quantidades?(o(),r("div",D,[(o(!0),r(p,null,g(n.jobs[e.id].quantidades,(t,d)=>(o(),r("div",{class:b([{"bg-green-300":t==n.jobs[e.id].arquivo[d],"bg-gray-100":t==0,"bg-amber-300":t!=n.jobs[e.id].arquivo[d]},"rounded p-2 flex justify-between"])},[s("label",null,a(d),1),s("label",null,"Registros inseridos: "+a(t)+" / "+a(n.jobs[e.id].arquivo[d]),1)],2))),256))])):u("",!0)],64)):u("",!0)],8,L)]))),256))])]))}};export{M as default};
